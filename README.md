# 京东万商商品数据爬虫

基于 Playwright + Stealth 的京东万商（b2b.jd.com）商品数据采集工具，支持自动登录、类目筛选、商品详情采集，并导出为 Excel 和 JSON 格式。

## 功能特性

- 自动登录京东万商平台，支持 Cookie 持久化
- 自动处理风控验证（需手动完成验证）
- 支持按类目筛选商品
- 自动滚动加载，确保获取完整商品列表
- 采集商品详情页数据：
  - 商品名称、品牌、分类
  - 价格（京东价、建议零售价）
  - 主图（多张）
  - 规格参数
  - 详情图（多张）
- 导出为 Excel (.xlsx) 和 JSON 格式

## 环境要求

- Python 3.8+
- 支持 Mac / Linux / Windows

## 快速开始

### 1. 安装依赖

**Mac / Linux:**
```bash
./install.sh
```

**Windows:**
```batch
install.bat
```

### 2. 配置账号

复制配置文件并填写账号信息：

```bash
cp .env.example .env
```

编辑 `.env` 文件：

```ini
# 京东万商账号
JD_USERNAME=你的用户名
JD_PASSWORD=你的密码

# 爬取配置
CATEGORY_NAME=坚果          # 类目名称（页面筛选区的选项）
START_PAGE=1                # 起始页
END_PAGE=3                  # 结束页
```

**可用类目示例：** 坚果、薯片薯条、其它膨化食品、糕点/饼、夹心饼干、薯片虾条、坚果蜜饯礼盒 等

### 3. 运行爬虫

**Mac / Linux:**
```bash
./run.sh
```

**Windows:**
```batch
run.bat
```

## 输出文件

采集结果保存在 `output/` 目录：

```
output/
├── products_类目名_时间戳.xlsx    # Excel 格式
└── products_类目名_时间戳.json    # JSON 格式
```

### Excel 字段说明

| 字段 | 说明 |
|------|------|
| SKU ID | 商品唯一标识 |
| 商品名称 | 商品标题 |
| 品牌 | 品牌名称 |
| 分类 | 商品分类 |
| 京东价 | B2B 采购价 |
| 建议零售价 | 建议零售价格 |
| 主图1-5 | 商品主图URL |
| 参数JSON | 规格参数（JSON格式） |
| 详情图数量 | 详情图张数 |
| 详情图列表 | 详情图URL列表 |

## 注意事项

1. **首次登录**：首次运行会打开浏览器进行登录，如遇验证码需手动完成
2. **Cookie 有效期**：登录成功后会保存 Cookie，下次运行可自动登录
3. **风控验证**：如遇到风控页面，请在浏览器中手动完成验证
4. **采集频率**：建议适当控制采集速度，避免触发风控

## 项目结构

```
b2b-js-crawl/
├── crawler_full.py      # 主爬虫脚本
├── requirements.txt     # Python 依赖
├── .env.example         # 配置文件模板
├── .env                 # 配置文件（需自行创建）
├── cookies.json         # 登录凭证（自动生成）
├── install.sh / .bat    # 安装脚本
├── run.sh / .bat        # 启动脚本
└── output/              # 输出目录
```

## 常见问题

**Q: 提示"未找到类目"怎么办？**

A: CATEGORY_NAME 必须是页面筛选区"类目"行中的选项。运行时如果找不到会列出可用类目。

**Q: 登录超时怎么办？**

A: 如果自动登录超时，会提示手动登录。在浏览器中完成登录后按 Enter 继续。

**Q: 采集数据不完整？**

A: 检查网络连接，确保页面完全加载。可以尝试增加等待时间或减少采集页数。

## License

MIT
